<?phprequire( __DIR__ . '/omoclass_common.php' );//. サイクル番号決定define( 'FN_NODE_PROF', _fn_last( 'profdb' ) );define( 'CYCLE', _fn2num( FN_NODE_PROF ) + 1 );$dn = _fn2( 'dn_cls', CYCLE );$o_db = new cls_sqlite( FN_DB );$o_dbout = _prep_profdb( CYCLE );//. 検索foreach ( range( 0, NUM_CLASS - 1 ) as $node_num ) {	_count(10);	$avg =[];	//- 読み込み	$table = [];	foreach ( _file( _fn2( 'cls', CYCLE, $node_num ) ) as $line ) {		$a = explode( "\t", $line );		$table[ $a[0] ] = $a[2];	}	/*	foreach ( $table as $i => $s ) {		$s = $s * 2 - 1;		if ( $s < 0.01 ) {			$s = 0.01;//			_m( "very low score: $node_num-$i -> $s" );		}		$table[ $i ] = $s;	}*/	$sum = array_sum( $table );//	$cnt = count( $res );	foreach ( $table as $id => $score ) {		$prof_set = _bin2prof( _get_data( $o_db, $id ) );		foreach ( $prof_set as $prof_num => $prof ) {			foreach ( $prof as $num => $val ) {				$avg[ $prof_num ][ $num ] += $val * $score / $sum;			}		}	}	$o_dbout->set([ $node_num, _prof2bin( $avg ), $avg[3][0], $avg[3][1], $avg[3][2] ]);}$o_dbout->end();